#Example on how to miscalibrate rec hits starting from rechits.


process ProcessOne = {
  include "FWCore/MessageLogger/data/MessageLogger.cfi"


 #######################################################################################
# input
  # input module. assume root file contains EcalRecHits
  source = PoolSource 
  {
    # Number of events program should run
    untracked vstring fileNames = {
    'file:./test.root'
    }
  }
untracked PSet maxEvents = {untracked int32 input = 10}

 #######################################################################################
#include "RecoLocalCalo/EcalRecProducers/data/ecalLocalRecoSequence.cff"
    es_source = CaloMiscalibTools{
	untracked string fileNameBarrel = "miscalib_barrel_0.05.xml"
	untracked string fileNameEndcap = "miscalib_endcap_0.05.xml"
	}
    es_prefer = CaloMiscalibTools{}



module miscalrechit = EcalRecHitRecalib {
    string ecalRecHitsProducer = "ecalRecHit"
    string barrelHitCollection = "EcalRecHitsEB"
    string endcapHitCollection = "EcalRecHitsEE"
    string RecalibBarrelHitCollection = "EcalRecHitsEB"
    string RecalibEndcapHitCollection = "EcalRecHitsEE"
    untracked double Refactor = 0.5
    untracked double Refactor_mean = 1.0	    
}

#include "RecoEcal/EgammaClusterProducers/data/ecalClusteringSequence.cff"  

#replace hybridSuperClusters.ecalhitproducer = "miscalrechit"
#replace correctedHybridSuperClusters.recHitProducer = "miscalrechit"

  module out = PoolOutputModule 
   {	
	untracked vstring outputCommands = 
	  {
	    "drop *",
	    "keep EcalRecHitsSorted_*_*_*"
	
	  }
     untracked string fileName = 'ecal_miscal_half.root'
   }



  path p = {miscalrechit}
  endpath ep = { out }
}

